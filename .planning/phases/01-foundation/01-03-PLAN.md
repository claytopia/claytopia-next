---
phase: 01-foundation
plan: 03
type: execute
wave: 3
depends_on: ["01-02"]
files_modified:
  - app/components/MobileMenu.tsx
  - app/components/Header.tsx
  - package.json
  - package-lock.json
autonomous: false
user_setup: []

must_haves:
  truths:
    - "Clicking hamburger icon opens a slide-out menu from the right"
    - "Menu shows navigation links: Clay Club, Brennservice, Workshops, Events, Kontakt"
    - "Pressing Escape closes the menu"
    - "Clicking a navigation link closes the menu"
    - "Background scrolling is disabled when menu is open"
    - "Focus is trapped within the open menu"
  artifacts:
    - path: "app/components/MobileMenu.tsx"
      provides: "Slide-out navigation with hamburger-react and focus-trap-react"
      min_lines: 60
      contains: "hamburger-react"
    - path: "app/components/Header.tsx"
      provides: "Header now uses MobileMenu instead of placeholder"
      contains: "MobileMenu"
  key_links:
    - from: "app/components/Header.tsx"
      to: "app/components/MobileMenu.tsx"
      via: "import and render"
      pattern: "import.*MobileMenu"
    - from: "app/components/MobileMenu.tsx"
      to: "hamburger-react"
      via: "npm package import"
      pattern: "from 'hamburger-react'"
    - from: "app/components/MobileMenu.tsx"
      to: "focus-trap-react"
      via: "npm package import"
      pattern: "from 'focus-trap-react'"
---

<objective>
Implement the fully functional hamburger navigation menu with slide-out panel, proper accessibility (focus trap, keyboard support), and smooth animations.

Purpose: Complete the navigation system so visitors can access all site sections on any device.
Output: Working MobileMenu component with hamburger-react, slide-out panel with navigation links, integrated into Header
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation/01-CONTEXT.md
@.planning/phases/01-foundation/01-RESEARCH.md
@.planning/phases/01-foundation/01-02-SUMMARY.md
@app/components/Header.tsx
@app/globals.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install hamburger-react and focus-trap-react</name>
  <files>package.json, package-lock.json</files>
  <action>
Install the required npm packages:

```bash
npm install hamburger-react focus-trap-react
```

These packages provide:
- hamburger-react: Animated hamburger icon with 14 animation styles, built-in accessibility
- focus-trap-react: Focus management for modal/overlay components

Verify installation by checking package.json includes both dependencies.
  </action>
  <verify>
Run `npm ls hamburger-react focus-trap-react` - both packages should be listed
Check package.json has both in dependencies
  </verify>
  <done>
hamburger-react and focus-trap-react installed and listed in package.json dependencies
  </done>
</task>

<task type="auto">
  <name>Task 2: Create MobileMenu component with slide-out panel</name>
  <files>app/components/MobileMenu.tsx</files>
  <action>
Create the MobileMenu component (app/components/MobileMenu.tsx):

```tsx
'use client';

import { useState, useEffect, useCallback } from 'react';
import { Squeeze } from 'hamburger-react';
import FocusTrap from 'focus-trap-react';

const navItems = [
  { href: '/clay-club', label: 'Clay Club' },
  { href: '/brennservice', label: 'Brennservice' },
  { href: '/workshops', label: 'Workshops' },
  { href: '/events', label: 'Events' },
  { href: '/kontakt', label: 'Kontakt' },
];

export function MobileMenu() {
  const [isOpen, setIsOpen] = useState(false);

  // Close menu on Escape key
  useEffect(() => {
    const handleEscape = (e: KeyboardEvent) => {
      if (e.key === 'Escape' && isOpen) {
        setIsOpen(false);
      }
    };
    document.addEventListener('keydown', handleEscape);
    return () => document.removeEventListener('keydown', handleEscape);
  }, [isOpen]);

  // Prevent body scroll when menu is open
  useEffect(() => {
    if (isOpen) {
      document.body.style.overflow = 'hidden';
    } else {
      document.body.style.overflow = '';
    }
    return () => {
      document.body.style.overflow = '';
    };
  }, [isOpen]);

  const closeMenu = useCallback(() => {
    setIsOpen(false);
  }, []);

  return (
    <>
      {/* Hamburger button */}
      <div className="relative z-50">
        <Squeeze
          toggled={isOpen}
          toggle={setIsOpen}
          size={24}
          color="currentColor"
          label="Navigation menu"
          rounded
        />
      </div>

      {/* Overlay and slide-out panel */}
      {isOpen && (
        <FocusTrap
          focusTrapOptions={{
            initialFocus: false,
            allowOutsideClick: true,
          }}
        >
          <div className="fixed inset-0 z-40">
            {/* Backdrop overlay */}
            <div
              className="absolute inset-0 bg-foreground/20 backdrop-blur-sm"
              onClick={closeMenu}
              aria-hidden="true"
            />

            {/* Slide-out panel */}
            <nav
              className="absolute right-0 top-0 h-full w-80 max-w-[calc(100%-3rem)] bg-background shadow-xl
                         transform transition-transform duration-300 ease-out"
              role="dialog"
              aria-modal="true"
              aria-label="Navigation"
            >
              {/* Panel header with close area */}
              <div className="flex h-16 items-center justify-end px-4">
                {/* The hamburger button handles close via toggle */}
              </div>

              {/* Navigation links */}
              <ul className="px-4 py-2">
                {navItems.map((item) => (
                  <li key={item.href}>
                    <a
                      href={item.href}
                      onClick={closeMenu}
                      className="block px-4 py-4 text-lg font-medium text-foreground
                                 rounded-lg hover:bg-background-alt
                                 focus:outline-none focus-visible:ring-2 focus-visible:ring-accent"
                    >
                      {item.label}
                    </a>
                  </li>
                ))}
              </ul>

              {/* Bottom section - contact info */}
              <div className="absolute bottom-8 left-0 right-0 px-8">
                <div className="border-t border-foreground/10 pt-6">
                  <p className="text-sm text-foreground-muted">Kontakt</p>
                  <a
                    href="tel:+491718336539"
                    className="mt-2 block text-foreground hover:text-accent"
                  >
                    +49 171 833 6539
                  </a>
                  <a
                    href="mailto:hello@claytopia.de"
                    className="mt-1 block text-foreground hover:text-accent"
                  >
                    hello@claytopia.de
                  </a>
                </div>
              </div>
            </nav>
          </div>
        </FocusTrap>
      )}
    </>
  );
}
```

Key implementation details:
- Uses 'use client' directive (required for useState, useEffect)
- Squeeze animation from hamburger-react (clean, minimal feel)
- FocusTrap wraps the entire overlay for accessibility
- Backdrop click closes menu
- Navigation items defined in array for easy updates
- Links include hover and focus-visible states
- Contact info at bottom for quick access
- Panel max-width ensures it doesn't cover entire screen on mobile
- Smooth CSS transition for slide-in effect
  </action>
  <verify>
File exists at app/components/MobileMenu.tsx
No TypeScript errors
Contains 'use client' directive
Imports hamburger-react and focus-trap-react
  </verify>
  <done>
MobileMenu component created with hamburger-react animation, focus-trap-react for accessibility, slide-out panel with navigation links and contact info
  </done>
</task>

<task type="auto">
  <name>Task 3: Integrate MobileMenu into Header</name>
  <files>app/components/Header.tsx</files>
  <action>
Update Header.tsx to use the MobileMenu component:

1. Remove the placeholder hamburger button and SVG icon
2. Import MobileMenu:
   ```tsx
   import { MobileMenu } from './MobileMenu';
   ```

3. Replace the hamburger placeholder with:
   ```tsx
   <MobileMenu />
   ```

The updated Header should look like:

```tsx
import { Container } from './Container';
import { MobileMenu } from './MobileMenu';

export function Header() {
  return (
    <header className="sticky top-0 z-40 w-full border-b border-foreground/10 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/80">
      <Container>
        <div className="flex h-16 items-center justify-between">
          {/* Logo/wordmark - left */}
          <a href="/" className="text-xl font-semibold tracking-tight text-foreground">
            Claytopia
          </a>

          {/* Navigation menu */}
          <MobileMenu />
        </div>
      </Container>
    </header>
  );
}
```
  </action>
  <verify>
Header.tsx imports and renders MobileMenu
No placeholder hamburger button/SVG remains
No TypeScript errors
  </verify>
  <done>
Header.tsx updated to use MobileMenu component, placeholder removed
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete navigation system with animated hamburger menu, slide-out panel, focus trap, and keyboard support
  </what-built>
  <how-to-verify>
1. Open http://localhost:3000 in browser
2. Click the hamburger icon (three lines on right side of header)
   - Menu should slide in from the right with smooth animation
   - Background should have dark overlay with blur
3. Verify navigation items visible: Clay Club, Brennservice, Workshops, Events, Kontakt
4. Click backdrop (dark area) - menu should close
5. Open menu again, press Escape key - menu should close
6. Open menu, try scrolling the page - background should NOT scroll
7. Open menu, press Tab key repeatedly - focus should stay within the menu (focus trap)
8. Click a navigation link - menu should close (links lead to 404, that's expected)
9. Test on mobile viewport (375px width in DevTools):
   - Hamburger icon visible and clickable
   - Menu panel doesn't cover entire screen (has left margin)
   - Navigation links are touch-friendly (large tap targets)
10. Verify contact info at bottom of menu: phone and email links
  </how-to-verify>
  <resume-signal>Type "approved" if navigation works correctly, or describe any issues found</resume-signal>
</task>

</tasks>

<verification>
After all tasks complete:
1. `npm run dev` starts without errors
2. Hamburger icon animates when clicked (transforms to X)
3. Menu slides in from right with smooth 300ms transition
4. Navigation links: Clay Club, Brennservice, Workshops, Events, Kontakt
5. Escape key closes menu
6. Backdrop click closes menu
7. Link click closes menu
8. Body scroll locked when menu open
9. Focus trapped within menu (Tab cycles through menu items only)
10. Contact info visible at bottom of menu
11. Works on both mobile (375px) and desktop (1440px) viewports
</verification>

<success_criteria>
- hamburger-react and focus-trap-react installed
- MobileMenu component renders animated hamburger and slide-out panel
- All 5 navigation items visible in menu
- Keyboard accessibility: Escape closes, Tab trapped within menu
- Body scroll locked when menu open
- Header uses MobileMenu instead of placeholder
- Visual checkpoint approved by user
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-03-SUMMARY.md`
</output>
